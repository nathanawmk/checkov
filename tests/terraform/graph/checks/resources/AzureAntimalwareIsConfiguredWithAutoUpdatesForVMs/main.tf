resource "azurerm_virtual_machine" "virtual_machine_good_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "f1cb3e39-c631-4750-b12b-4ac0d64b3bd1"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "dc79a8e1-4997-494f-95c8-16529feeb4b6"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_2" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "ff65920d-564a-4ef0-8c8d-556b0efd83e4"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_3" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "608df15a-7896-428f-8289-11ff640781b7"
  }
}

resource "azurerm_virtual_machine_extension" "extension_good_1" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_good_1.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "88d2b561-6484-4c1b-aa71-5213d0113894"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_1" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_1.id
  publisher                  = "Microsoft.Azure.Extensions"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "22acc2ee-f107-4bb7-8281-51113de54d9d"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_2" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_2.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = false
  tags = {
    yor_trace = "ce0871b6-b3af-4451-95d3-9889497cbc4d"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_3" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_3.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "CustomScript"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "a9e6cb80-63ec-4b67-88cc-3cd68f44a467"
  }
}